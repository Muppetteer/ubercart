<?php

/**
 * @file
 * Contains global Ubercart functions and store administration functionality.
 */


/**
 * Returns a list of all installed/available countries.
 *
 * @return array
 *   Associative array keyed by the country's ISO 3166-1 alpha_2 country
 *   code and containing the translated ISO 3166-1 country name.
 */
function uc_country_option_list() {
  $countries = \Drupal::entityManager()->getStorage('uc_country')->loadByProperties(['status' => TRUE]);
  $country_names = [];
  foreach ($countries as $alpha_2 => $country) {
    $country_names[$alpha_2] = t($country->name);
  }
  natcasesort($country_names);
  return $country_names;
}

/**
 * Helper function to return zone options, grouped by country.
 */
function uc_zone_option_list() {
  $options = array();
  $countries = \Drupal::entityManager()->getStorage('uc_country')->loadByProperties(['status' => TRUE]);
  foreach ($countries as $country) {
    if (!empty($country->zones)) {
      $options[t($country->name)] = $country->zones;
    }
  }
  uksort($options, 'strnatcasecmp');

  return $options;
}
